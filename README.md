# memory_pool

C++11内存池

内存池的作用：
1. 预分配和批量分配内存，减少内存碎片
2. 提升内存分配效率

# To do:
1. 链表free_memory中的ptr可以去掉，每分配一个对象可减少一个指针分配(4字节或8字节)；
2. 加锁会严重损失性能，使得内存池不能提升内存分配效率。考虑使用thread_local或memory_fency解决;
3. new[]和delete[]待实现。

# 性能测试
目前使用的是加锁实现，实测同样的分配逻辑下：

64字节对象，分配和释放1百万次：


内存池不加锁(单线程)：

real    0m0.046s

user    0m0.045s

sys     0m0.000s


内存池加锁：

real    0m0.153s

user    0m0.150s

sys     0m0.000s


普通分配方式：

real    0m0.060s

user    0m0.057s

sys     0m0.001s


可以看到该场景下，无锁的内存池分配，相比malloc-free时间减少了23%，提升效果明显。

加锁实现的内存池反而效率低下。所以，不能使用加锁实现内存池！！！
